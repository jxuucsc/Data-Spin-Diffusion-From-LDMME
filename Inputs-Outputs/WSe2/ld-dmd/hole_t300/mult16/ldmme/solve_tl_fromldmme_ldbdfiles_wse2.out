dim =  2
R = 
 [[ 6.27389 -3.13695  0.     ]
 [ 0.       5.43335  0.     ]
 [ 0.       0.      26.     ]]
volume =  886.2942460189998
area =  34.088240231499995
R:
 [[ 6.27389 -3.13695  0.     ]
 [ 0.       5.43335  0.     ]
 [ 0.       0.      26.     ]]
G:
 [[1.00148 0.57821 0.     ]
 [0.      1.15641 0.     ]
 [0.      0.      0.24166]]
cell_size =  34.088240231499995

##################################################
read and compute electronic quantities
##################################################
isMetal =  False
has_h =  True
nb =  1
nk_full =  36864.0  nk =  1160  , kmesh =  [192 192   1]
nkpair =  651304
T =  0.000950043414701698
emin =  -0.0066503039  emax =  0.023154053

##################################################
kmapper
##################################################
[   0    1    2 ... 1157 1158 1159]
i =  0
k:
 [[0.33333 0.33333 0.     ]
 [0.66667 0.66667 0.     ]
 [0.33333 0.33854 0.     ]
 ...
 [0.66146 0.65625 0.     ]
 [0.32812 0.32812 0.     ]
 [0.66146 0.66146 0.     ]]
km:
 [0.32812 0.66146 0.32812 ... 0.65625 0.32292 0.65625]
kp:
 [0.33854 0.67188 0.33854 ... 0.66667 0.33333 0.66667]
left neighbs:
 [1104 1105 1106 ... 1101 1102 1103]
right neighbs:
 [1104 1105 1106 ... 1101 1102 1103]
i =  1
k:
 [[0.33333 0.33333 0.     ]
 [0.66667 0.66667 0.     ]
 [0.33333 0.33854 0.     ]
 ...
 [0.66146 0.65625 0.     ]
 [0.32812 0.32812 0.     ]
 [0.66146 0.66146 0.     ]]
km:
 [0.32812 0.66146 0.33333 ... 0.65104 0.32292 0.65625]
kp:
 [0.33854 0.67188 0.34375 ... 0.66146 0.33333 0.66667]
left neighbs:
 [  48   49    0 ... 1155 1156 1157]
right neighbs:
 [  48   49    0 ... 1155 1156 1157]
time for kmapper:  0.09396604727953672
Ek: [[-1.52933e-14]
 [ 1.09107e-13]
 [-5.19614e-05]
 [-5.32480e-05]
 [-2.08022e-04]
 [-2.10540e-04]
 [-4.64882e-04]
 [-4.68523e-04]
 [-8.17285e-04]
 [-8.21896e-04]]
vbm in eV =  2.96895728371607e-12
number of iterations:  33  , err =  0.80853915860746
final mu =  1.547193e-01 eV
fk: [[0.99749]
 [0.99749]
 [0.99762]
 [0.99763]
 [0.99798]
 [0.99799]
 [0.99846]
 [0.99847]
 [0.99894]
 [0.99894]]

electron density =  0.000e+00 in cm^-d
hole density =  1.000e+10 in cm^-d
excess density = -1.000e+10 in cm^-d

sk:
 [[[[ 8.00790e-11+6.53909e-19j]]

  [[-1.93617e-11-5.99276e-18j]]

  [[-4.99546e-01-1.85980e-15j]]]


 [[[-7.67384e-11-6.08170e-18j]]

  [[-1.47547e-11-2.81622e-17j]]

  [[ 4.99546e-01-8.74735e-16j]]]


 [[[-5.95090e-06+1.25835e-17j]]

  [[-2.70593e-06-1.99502e-17j]]

  [[-4.99535e-01-1.82408e-15j]]]]
mask_Ek:
 [[ True]
 [ True]
 [ True]
 ...
 [ True]
 [ True]
 [ True]]

number of states within [emin,emax]:  1160  ( 1160 )
number of elements of rho left:  1160  ( 1160 )
mask_Ek and mask_rho are right
nb_k =  [1 1 1 ... 1 1 1]
ind_k_state =  [   0    1    2 ... 1158 1159 1160]
time for electron:  0.12594052124768496

##################################################
read and compute e-ph quantities
##################################################
time for e-ph setup:  1.767807174474001

--------------------------------------------------
carrier transport from conventional method
--------------------------------------------------
carrier lifetime (rate average) in ps:  0.003309717862082587
carrier lifetime (time average) in ps:  0.003321665294376585
momentum lifetime (rate average) in ps:  0.01640263456625678
momentum lifetime (time average) in ps:  0.03163077001891374
momentum lifetime (type 2, rate average) in ps:  0.000249999582447252
momentum lifetime (type 2, time average) in ps:  0.025579245031557698
average of v^2 =  [2.44322e-03 2.44293e-03 1.71659e-11]
Fermi velocity in m/s =  [1.08135e+05 1.08129e+05 9.06398e+00]
conductivity using tau in S =  [2.52420e-08 2.52387e-08 1.87885e-16]
conductivity using taum in S =  [3.82440e-07 3.82790e-07 3.87252e-15]
conductivity using taum2 in S =  [2.57774e-07 2.57810e-07 2.47428e-15]
mobility using tau in cm^2/V/s =  [1.57548e+01 1.57528e+01 1.17268e-07]
mobility using taum in cm^2/V/s =  [2.38700e+02 2.38919e+02 2.41704e-06]
mobility using taum2 in cm^2/V/s =  [1.60890e+02 1.60912e+02 1.54433e-06]
time for compute_carrier_transport_conventional:  0.049769009463489056

==================================================
carrier transport within RTA with tau =  0.003321665294376585  ps
==================================================

--------------------------------------------------
carrier transport from linearized DMME
--------------------------------------------------
conductivity in S =  [ 2.40425e-08 -2.50830e-12 -3.27762e-13]
spin conductivity of Sx in S =  [-3.28285e-18  1.10716e-18 -3.54956e-21]
spin conductivity of Sy in S =  [ 1.40286e-18 -1.26187e-18  1.46707e-21]
spin conductivity of Sz in S =  [1.10668e-16 6.38133e-17 1.40202e-16]
mobility in cm^2/V/s =  [ 1.50061e+01 -1.56556e-03 -2.04573e-04]


==================================================
carrier transport within RTA with tau =  0.03163077001891374  ps
==================================================

--------------------------------------------------
carrier transport from linearized DMME
--------------------------------------------------
conductivity in S =  [ 2.28946e-07 -2.38854e-11 -3.12114e-12]
spin conductivity of Sx in S =  [-3.12612e-17  1.05430e-17 -3.38009e-20]
spin conductivity of Sy in S =  [ 1.33588e-17 -1.20162e-17  1.39702e-20]
spin conductivity of Sz in S =  [1.05384e-15 6.07666e-16 1.33509e-15]
mobility in cm^2/V/s =  [ 1.42897e+02 -1.49081e-02 -1.94806e-03]


==================================================
carrier transport within RTA with tau =  0.025579245031557698  ps
==================================================

--------------------------------------------------
carrier transport from linearized DMME
--------------------------------------------------
conductivity in S =  [ 1.85145e-07 -1.93157e-11 -2.52401e-12]
spin conductivity of Sx in S =  [-2.52804e-17  8.52597e-18 -2.73342e-20]
spin conductivity of Sy in S =  [ 1.08030e-17 -9.71729e-18  1.12975e-20]
spin conductivity of Sz in S =  [8.52224e-16 4.91409e-16 1.07966e-15]
mobility in cm^2/V/s =  [ 1.15558e+02 -1.20559e-02 -1.57536e-03]

carrier lifetime (rate average) in ps:  0.0033097178620825887
effetive lifetime (single element of rho, rate average) in ps:  0.0033097178620825887
time for e-ph:  0.06472931988537312

time for set up and some simple analysis:  1.9781186329200864

##################################################
solving spin lifetimes via linear algebra and analysis decay modes
##################################################

--------------------------------------------------
solve -L x = x e :
--------------------------------------------------
rates:
 [3.57747e-18+5.78762e-23j 3.05000e-07+7.34957e-23j
 5.46612e-04-8.12205e-23j 5.47716e-04-7.50924e-24j
 6.11235e-04+1.35926e-22j 6.11663e-04+1.70198e-22j
 6.11769e-04+1.45260e-22j 6.12194e-04+2.65667e-22j
 8.91315e-04-6.70687e-22j 8.91344e-04+7.80283e-22j]
spin lifetimes in ps:
 [6.76144e+12 7.93077e+01 4.42523e-02 4.41632e-02 3.95737e-02 3.95460e-02
 3.95391e-02 3.95117e-02 2.71384e-02 2.71375e-02]
precession freq. in au:
 [ 5.78762e-23  7.34957e-23 -8.12205e-23 -7.50924e-24  1.35926e-22
  1.70198e-22  1.45260e-22  2.65667e-22 -6.70687e-22  7.80283e-22]
short lifetimes in ps:
 [0.00267 0.00267 0.00267 0.00267 0.00267 0.00267 0.00267 0.00264 0.00264
 0.00264]

time for solving lifetimes via lin. alg.:  0.09409066755324602

Analyse decay mode:

The 4 observables and perturbations are:
n, sx, sy, sz
ob. proj. to VR = 
 [[ 7.07204e-01+1.89252e-16j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j -3.52782e-01+2.32233e-16j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j -3.07335e-04-1.72560e-16j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]]
rhopert. proj. to VL = 
 [[-0.7072 +1.89252e-16j  0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.70988-5.91962e-14j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.0064 -1.61644e-13j]
 [ 0.     +0.00000e+00j -0.00811+1.74927e-13j]
 [ 0.     +0.00000e+00j  0.00642-5.29201e-14j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j -0.00151+4.54508e-15j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j]]
ob. of pert:
 [[-5.00137e-01  0.00000e+00]
 [-7.19174e-08 -2.50435e-01]]

mode  0  with rate  2.7952711606176672e+17
pert. and ob.:
 [[-5.00137e-01  0.00000e+00]
 [-7.19216e-08  0.00000e+00]]

mode  1  with rate  3278690.968545228
pert. and ob.:
 [[ 0.       0.     ]
 [ 0.      -0.25043]]

mode  2  with rate  1829.4500348940708
pert. and ob.:
 [[0. 0.]
 [0. 0.]]

mode  3  with rate  1825.7653669640001
pert. and ob.:
 [[ 0.00000e+00  0.00000e+00]
 [ 0.00000e+00 -1.96584e-06]]

mode  4  with rate  1636.033070404253
pert. and ob.:
 [[0. 0.]
 [0. 0.]]

mode  5  with rate  1634.8875469090435
pert. and ob.:
 [[0. 0.]
 [0. 0.]]

mode  6  with rate  1634.6026487343556
pert. and ob.:
 [[0. 0.]
 [0. 0.]]

mode  7  with rate  1633.469291710685
pert. and ob.:
 [[0. 0.]
 [0. 0.]]

mode  8  with rate  1121.9377992422496
pert. and ob.:
 [[0. 0.]
 [0. 0.]]

mode  9  with rate  1121.9009098633785
pert. and ob.:
 [[0. 0.]
 [0. 0.]]

do real-time dynamics with tmax (in ps)  79.3077419553214
1160  (of  1160 ) modes are considered in real-time simulation
Szt_szpert (exp): tau =  79.30713965662977  ps
Szt_szpert (exp cos phi=0): tau =  79.30713965661204  ps  period =  2164807836.2515483 ps
Szt_szpert (exp cos): tau =  79.30773661008537  ps  period =  -449634240.57270515 ps  phi =  -0.0038786971301418673

time for spin lifetime:  0.38880840968340635

##################################################
solving lifetimes approximately
##################################################

--------------------------------------------------
Rayleigh-Ritz method (material dependent):
--------------------------------------------------
Rayleigh-Ritz ( 1  vec.,   ) lifetime in ps:
 [41.23561]

Rayleigh-Ritz ( 1  vec.,  with Left ) lifetime in ps:
 [78.44127]

Rayleigh-Ritz ( 2  vec.,   ) lifetime in ps:
 [1.34685e+02 1.41477e-02]

Rayleigh-Ritz ( 2  vec.,  with Left ) lifetime in ps:
 [ 7.84252e+01 -3.90729e-03]

Rayleigh-Ritz ( 4  vec.,   ) lifetime in ps:
 [-4.19843e+01  2.59691e-02  9.06560e-03  4.80275e-03]

Rayleigh-Ritz ( 4  vec.,  with Left ) lifetime in ps:
 [7.93235e+01 4.20456e-02 1.68111e-02 5.30679e-03]

Rayleigh-Ritz ( 10  vec.,   ) lifetime in ps:
 [1.11335e+02 4.06863e-02 2.29741e-02 1.32276e-02 9.46056e-03 6.81556e-03
 5.47158e-03 4.51188e-03 3.87227e-03 3.46479e-03]

Rayleigh-Ritz ( 10  vec.,  with Left ) lifetime in ps:
 [7.93078e+01 4.43026e-02 2.51307e-02 1.34728e-02 9.77028e-03 6.79565e-03
 6.79565e-03 4.70148e-03 4.70148e-03 3.49443e-03]

Rayleigh-Ritz ( 10  vec.,  with Left ) lifetime in ps:
 [7.93078e+01 4.43026e-02 2.51307e-02 1.34728e-02 9.77028e-03 6.79565e-03
 6.79565e-03 4.70148e-03 4.70148e-03 3.49443e-03]


time for Rayleigh-Ritz lifetime:  0.1212129108607769

##################################################
solving spin diffusion length
##################################################

--------------------------------------------------
solving -L^(-1) Lv x = x lambda^(-1)
--------------------------------------------------

--------------------------------------------------
carrier transport from linearized DMME
--------------------------------------------------
conductivity in S =  [2.35557e-07 1.03534e-09 1.65586e-11]
spin conductivity of Sx in S =  [-6.38350e-16 -7.19180e-16  2.40377e-21]
spin conductivity of Sy in S =  [-1.12323e-16  3.35280e-16  1.30938e-19]
spin conductivity of Sz in S =  [-2.53629e-15  1.47948e-14  1.65301e-15]
mobility in cm^2/V/s =  [1.47023e+02 6.46206e-01 1.03350e-02]

effective lifetime in ps:  0.026662599818608804
spin diffusion length using pinv of L in micro-meter:
 [-0.17345  0.17345 -0.00883  0.00883 -0.00745  0.00745 -0.00618  0.00618
 -0.00548  0.00548  0.00447 -0.00447 -0.00436  0.00436 -0.00399  0.00399
 -0.00371  0.00371 -0.00357  0.00357]
precession freq. in au:
 [-1.33238e-17 -1.40766e-17 -3.76943e-18 -1.28744e-17 -8.02078e-18
 -2.06400e-17 -2.72265e-18 -1.44778e-17 -9.70077e-18 -2.91800e-17
 -2.04183e-17 -4.64878e-18 -7.69650e-18 -3.05723e-17 -1.17824e-17
 -3.69453e-17 -7.04180e-18 -2.46412e-17 -1.41231e-17 -4.35466e-17]
short diffusion length using pinv of L in micro-meter:
 [-1.31169e-05  1.14738e-05 -1.14738e-05 -9.93613e-06  9.93613e-06
  9.80789e-06 -9.80785e-06  5.86465e-06 -5.86465e-06  4.66247e-06
 -4.66247e-06 -3.49430e-06  3.49427e-06  3.37543e-06 -3.37538e-06
  1.44658e-06 -1.44658e-06  8.37409e-07 -8.37409e-07  3.62509e-13]

time for solving diffusion lengths via lin. alg.:  0.1355198584496975

Analyse decay mode:

The 4 observables and perturbations are:
n, sx, sy, sz
ob. proj. to VR = 
 [[ 0.     +0.00000e+00j  2.24609-2.38208e-15j]
 [ 0.     +0.00000e+00j -2.24609+1.57210e-15j]
 [ 0.     +0.00000e+00j -0.22211-5.64546e-16j]
 [ 0.     +0.00000e+00j  0.22211-3.54463e-15j]
 [ 0.     +0.00000e+00j  0.75204-5.40717e-16j]
 [ 0.     +0.00000e+00j -0.75204+9.14892e-16j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j -0.00241-9.68517e-17j]
 [ 0.     +0.00000e+00j  0.00241+3.47420e-16j]]
rhopert. proj. to VL = 
 [[ 0.00278-2.70162e-15j -0.05749+2.78912e-14j]
 [ 0.00278-2.94707e-15j  0.05749-5.30473e-14j]
 [ 0.02769+8.87461e-17j -0.00425+3.64222e-14j]
 [ 0.02769-2.16634e-16j  0.00425-3.99835e-14j]
 [ 0.00556-5.89488e-17j  0.00656-1.46592e-13j]
 [ 0.00556-3.28526e-16j -0.00656+1.55739e-13j]
 [ 0.     +0.00000e+00j  0.00081-1.20921e-14j]
 [ 0.     +0.00000e+00j -0.00081+1.28644e-14j]
 [ 0.     +0.00000e+00j -0.00149+4.93672e-14j]
 [ 0.     +0.00000e+00j  0.00149-4.68114e-14j]]
ob. of pert:
 [[-5.00137e-01  0.00000e+00]
 [-7.19174e-08 -2.50435e-01]]

mode  0  with rate  -3277.8046689684766
pert. and ob.:
 [[ 0.       0.00625]
 [ 0.      -0.12913]]

mode  1  with rate  3277.8027414211383
pert. and ob.:
 [[ 0.      -0.00625]
 [ 0.      -0.12912]]

mode  2  with rate  -166.77263640491356
pert. and ob.:
 [[ 0.      -0.00615]
 [ 0.       0.00094]]

mode  3  with rate  166.7726334002883
pert. and ob.:
 [[0.      0.00615]
 [0.      0.00094]]

mode  4  with rate  -140.803076026871
pert. and ob.:
 [[0.      0.00418]
 [0.      0.00493]]

mode  5  with rate  140.80307241421755
pert. and ob.:
 [[ 0.      -0.00418]
 [ 0.       0.00493]]

mode  6  with rate  -116.86528616186607
pert. and ob.:
 [[0.00000e+00 0.00000e+00]
 [0.00000e+00 7.89329e-08]]

mode  7  with rate  116.86528581657016
pert. and ob.:
 [[0.00000e+00 0.00000e+00]
 [0.00000e+00 7.89678e-08]]

mode  8  with rate  -103.5625040223837
pert. and ob.:
 [[0.00000e+00 1.12895e-07]
 [0.00000e+00 3.58960e-06]]

mode  9  with rate  103.56250114428515
pert. and ob.:
 [[ 0.00000e+00 -1.12892e-07]
 [ 0.00000e+00  3.58881e-06]]

do real-space simulations with xmax (in micro-meter)  0.17345395326121918
581  (of  1160 ) modes are considered in real-space simulation
Szx_szpert (exp): tau =  0.17877596779624116  micro-meter
Szx_szpert (exp cos phi=0): tau =  0.18397538776284056  micro-meter  period =  5.814143693068103
Szx_szpert (exp cos): tau =  0.18389607527225085  micro-meter  period =  -5.809477695966343 micro-meter  phi =  87.9669257673668

time for diffusion length:  0.3534975089132786

##################################################
solving approximate diffusion lengths
##################################################

--------------------------------------------------
Rayleigh-Ritz method:
--------------------------------------------------
Rayleigh-Ritz ( 2  vec.,  sz vsz ) diffusion length in micro-meter:
 [-0.10534  0.10534]
precession frequency: [-3.58838e-17 -3.74012e-17]

Rayleigh-Ritz ( 2  vec.,  sz vsz, with Left ) diffusion length in micro-meter:
 [-0.16454  0.16454]
precession frequency: [-1.46939e-17 -1.55542e-17]

Rayleigh-Ritz ( 4  vec.,  sz vsz Lsz Lvsz ) diffusion length in micro-meter:
 [-0.14283  0.14283 -0.00103  0.00103]
precession frequency: [-3.72240e-17 -1.15045e-18 -1.43854e-16 -2.87617e-16]

Rayleigh-Ritz ( 4  vec.,  sz vsz Lsz Lvsz, with Left ) diffusion length in micro-meter:
 [-0.1718   0.1718  -0.00207  0.00207]
precession frequency: [-1.27921e-17 -1.24877e-17 -9.63819e-17 -1.46252e-16]


time for approximate diffusion length:  0.0853809043765068
total time:  2.927018366754055
