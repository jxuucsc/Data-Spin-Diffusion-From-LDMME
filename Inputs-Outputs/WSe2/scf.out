
*************** jdftx 1.7  ***************

Start date and time: Sun Nov 24 20:58:07 2024
Executable /home/xujq/codes/jdftx/jdftx-202404/build/jdftx with command-line: -i scf.in
Running on hosts (process indices):  node22 (0-13)  node23 (14-27)
Divided in process groups (process indices):  0 (0)  1 (1)  2 (2)  3 (3)  4 (4)  5 (5)  6 (6)  7 (7)  8 (8)  9 (9)  10 (10)  11 (11)  12 (12)  13 (13)  14 (14)  15 (15)  16 (16)  17 (17)  18 (18)  19 (19)  20 (20)  21 (21)  22 (22)  23 (23)  24 (24)  25 (25)  26 (26)  27 (27)
Resource initialization completed at t[s]:      0.01
Run totals: 28 processes, 112 threads, 0 GPUs


Input parsed successfully to the following command list (including defaults):

basis kpoint-dependent
converge-empty-states yes
coords-type Lattice
core-overlap-check vector
coulomb-interaction Slab 001
coulomb-truncation-embed 0 0 0
davidson-band-ratio 1.1
dump End State EigStats
dump Init Symmetries Kpoints Gvectors
dump-name totalE.$VAR
elec-cutoff 31
elec-eigen-algo Davidson
elec-ex-corr gga-PBE
elec-n-bands 50
electronic-minimize  \
	dirUpdateScheme      FletcherReeves \
	linminMethod         DirUpdateRecommended \
	nIterations          100 \
	history              15 \
	knormThreshold       0 \
	maxThreshold         no \
	energyDiffThreshold  1e-08 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
electronic-scf  \
	nIterations	300 \
	energyDiffThreshold	1e-06 \
	residualThreshold	1e-07 \
	mixFraction	0.5 \
	qMetric	0.8 \
	history	10 \
	nEigSteps	2 \
	eigDiffThreshold	1e-08 \
	mixedVariable	Density \
	qKerker	0.8 \
	qKappa	-1 \
	verbose	no \
	mixFractionMag	1.5
exchange-regularization WignerSeitzTruncated
fluid None
fluid-ex-corr (null) lda-PZ
fluid-gummel-loop 10 1.000000e-05
fluid-minimize  \
	dirUpdateScheme      PolakRibiere \
	linminMethod         DirUpdateRecommended \
	nIterations          100 \
	history              15 \
	knormThreshold       0 \
	maxThreshold         no \
	energyDiffThreshold  0 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
fluid-solvent H2O 55.338 ScalarEOS \
	epsBulk 78.4 \
	pMol 0.92466 \
	epsInf 1.77 \
	Pvap 1.06736e-10 \
	sigmaBulk 4.62e-05 \
	Rvdw 2.61727 \
	Res 1.42 \
	tauNuc 343133 \
	poleEl 15 7 1
forces-output-coords Positions
initial-state totalE.$VAR
ion W   0.000000000000000  -0.000000000000000   0.000000000000000 0
ion Se   0.666666666666667   0.333333333333333   0.121870594399722 1
ion Se   0.666666666666667   0.333333333333333  -0.121870594399722 1
ion-species /home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/W.upf
ion-species /home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/Se_fr_nv6.upf
ion-width 0
ionic-minimize  \
	dirUpdateScheme      L-BFGS \
	linminMethod         DirUpdateRecommended \
	nIterations          0 \
	history              15 \
	knormThreshold       0.0001 \
	maxThreshold         no \
	energyDiffThreshold  1e-06 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
kpoint   0.000000000000   0.000000000000   0.000000000000  1.00000000000000
kpoint-folding 12 12 1 
latt-move-scale 1 1 1
latt-scale 1 1 1 
lattice Hexagonal 6.27389 26
lattice-minimize  \
	dirUpdateScheme      L-BFGS \
	linminMethod         DirUpdateRecommended \
	nIterations          0 \
	history              15 \
	knormThreshold       0 \
	maxThreshold         no \
	energyDiffThreshold  1e-06 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
lcao-params -1 1e-06 0.001
pcm-variant GLSSA13
perturb-minimize  \
	nIterations            0 \
	algorithm              MINRES \
	residualTol            0.0001 \
	residualDiffThreshold  0.0001 \
	CGBypass               no \
	recomputeResidual      no
spintype spin-orbit
subspace-rotation-factor 1 yes
symmetries automatic
symmetry-threshold 0.0001



---------- Setting up symmetries ----------

Found 24 point-group symmetries of the bravais lattice
Found 12 space-group symmetries with basis
Applied RMS atom displacement 1.75008e-15 bohrs to make symmetries exact.

---------- Initializing the Grid ----------
R = 
[      6.27389     -3.13695            0  ]
[            0      5.43335            0  ]
[            0            0           26  ]
unit cell volume = 886.295
G =
[    1.00148   0.578205         -0  ]
[          0    1.15641          0  ]
[          0         -0   0.241661  ]
Minimum fftbox size, Smin = [  32  32  132  ]
Chosen fftbox size, S = [  32  32  140  ]

---------- Exchange Correlation functional ----------
Initalized PBE GGA exchange.
Initalized PBE GGA correlation.

---------- Setting up pseudopotentials ----------
Width of ionic core gaussian charges (only for fluid interactions / plotting) set to 0

Reading pseudopotential file '/home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/W.upf':
  'W' pseudopotential, 'PBE' functional
  Generated using ONCVPSP code by D. R. Hamann
  Author: anonymous  Date: 180416.
  14 valence electrons, 6 orbitals, 14 projectors, 1396 radial grid points, with lMax = 3
  Transforming local potential to a uniform radial grid of dG=0.02 with 1817 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 537 points.
    5S    l: 0   occupation:  2.0   eigenvalue: -2.899149
    5P    l: 1   occupation:  4.0   eigenvalue: -1.486754
    5P    l: 1   occupation:  2.0   eigenvalue: -1.847599
    5D    l: 2   occupation:  2.4   eigenvalue: -0.154393
    5D    l: 2   occupation:  1.6   eigenvalue: -0.181151
    6S    l: 0   occupation:  2.0   eigenvalue: -0.210123
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 537 points.
  Transforming core density to a uniform radial grid of dG=0.02 with 1817 points.
  Core radius for overlap checks: 2.00 bohrs.

Reading pseudopotential file '/home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/Se_fr_nv6.upf':
  'Se' pseudopotential, 'PBE' functional
  Generated using ONCVPSP code by D. R. Hamann
  Author: anonymous  Date: 190811.
  6 valence electrons, 3 orbitals, 8 projectors, 1214 radial grid points, with lMax = 2
  Transforming local potential to a uniform radial grid of dG=0.02 with 1817 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 537 points.
    4S    l: 0   occupation:  2.0   eigenvalue: -0.635120
    4P    l: 1   occupation:  2.7   eigenvalue: -0.234806
    4P    l: 1   occupation:  1.3   eigenvalue: -0.248593
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 537 points.
  Transforming core density to a uniform radial grid of dG=0.02 with 1817 points.
  Core radius for overlap checks: 1.88 bohrs.

Initialized 2 species with 3 total atoms.

Folded 1 k-points by 12x12x1 to 144 k-points.

---------- Setting up k-points, bands, fillings ----------
Adding inversion symmetry to k-mesh for non-inversion-symmetric unit cell.
Reduced to 19 k-points under symmetry. 
Computing the number of bands and number of electrons
Calculating initial fillings.
nElectrons:  26.000000   nBands: 50   nStates: 19

----- Setting up reduced wavefunction bases (one per k-point) -----
average nbasis = 7308.118 , ideal nbasis = 7306.590

---------- Setting up coulomb interaction ----------
Setting up double-sized grid for truncated Coulomb potentials:
R = 
[      6.27389     -3.13695            0  ]
[            0      5.43335            0  ]
[            0            0           52  ]
unit cell volume = 1772.59
G =
[    1.00148   0.578205         -0  ]
[          0    1.15641          0  ]
[          0         -0    0.12083  ]
Chosen fftbox size, S = [  32  32  280  ]
Integer grid location selected as the embedding center:
   Grid: [  0  0  0  ]
   Lattice: [  0  0  0  ]
   Cartesian: [  0  0  0  ]
Constructing Wigner-Seitz cell: 8 faces (6 quadrilaterals, 2 hexagons)
Range-separation parameter for embedded mesh potentials due to point charges: 0.558603 bohrs.
Initialized slab truncation along lattice direction 001

---------- Setting up 2D ewald sum ----------
Optimum gaussian width for ewald sums = 3.483012 bohr.
Real space sums over 289 unit cells with max indices [  8  8  0  ]
Reciprocal space sums over 81 terms with max indices [  4  4  0  ]

---------- Allocating electronic variables ----------
Initializing wave functions:  linear combination of atomic orbitals
Note: number of bands (50) exceeds available atomic orbitals (36)
W pseudo-atom occupations:   s ( 2 2 )  p- ( 2 )  p+ ( 4 )  d- ( 4 )  d+ ( 0 )
Se pseudo-atom occupations:   s ( 2 )  p- ( 2 )  p+ ( 2 )
	FillingsUpdate:  mu: -0.371094977  nElectrons: 26.000000
LCAOMinimize: Iter:   0  Etot: -88.1339950118536848  |grad|_K:  3.566e-03  alpha:  1.000e+00
	FillingsUpdate:  mu: -0.313687893  nElectrons: 26.000000
LCAOMinimize: Iter:   1  Etot: -88.1787470480046949  |grad|_K:  1.706e-03  alpha:  9.777e-02  linmin: -2.744e-01  cgtest:  9.624e-01  t[s]:     15.61
LCAOMinimize: Encountered beta<0, resetting CG.
	FillingsUpdate:  mu: -0.222690976  nElectrons: 26.000000
LCAOMinimize: Iter:   2  Etot: -88.1909839955688000  |grad|_K:  1.906e-04  alpha:  1.822e-01  linmin:  1.617e-01  cgtest: -4.990e-01  t[s]:     19.54
LCAOMinimize: 	Predicted alpha/alphaT>3.000000, increasing alphaT to 5.464800e-01.
	FillingsUpdate:  mu: -0.216750790  nElectrons: 26.000000
LCAOMinimize: Iter:   3  Etot: -88.1913878299082228  |grad|_K:  1.414e-04  alpha:  6.931e-01  linmin:  4.833e-03  cgtest:  6.301e-01  t[s]:     22.57
LCAOMinimize: None of the convergence criteria satisfied after 3 iterations.


Dumping 'totalE.sym' ... done
Dumping 'totalE.kPts' ... done
Dumping 'totalE.kMap' ... done
Dumping 'totalE.Gvectors' ... done

---- Citations for features of the code used in this run ----

   Software package:
      R. Sundararaman, K. Letchworth-Weaver, K.A. Schwarz, D. Gunceler, Y. Ozhabes and T.A. Arias, 'JDFTx: software for joint density-functional theory', SoftwareX 6, 278 (2017)

   gga-PBE exchange-correlation functional:
      J.P. Perdew, K. Burke and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)

   Truncated Coulomb potentials:
      R. Sundararaman and T.A. Arias, Phys. Rev. B 87, 165122 (2013)

This list may not be complete. Please suggest additional citations or
report any other bugs at https://github.com/shankar1729/jdftx/issues

Initialization completed successfully at t[s]:     22.80


-------- Electronic minimization -----------
Will mix electronic density at each iteration.
SCF: Cycle:  0   Etot: -88.272062525675125   dEtot: -8.067e-02   |Residual|: 1.402e-01   |deigs|: 1.533e-01  t[s]:     24.92
SCF: Cycle:  1   Etot: -88.313906767402159   dEtot: -4.184e-02   |Residual|: 6.295e-02   |deigs|: 9.958e-03  t[s]:     26.35
SCF: Cycle:  2   Etot: -88.333712654377948   dEtot: -1.981e-02   |Residual|: 1.714e-02   |deigs|: 6.090e-03  t[s]:     27.77
SCF: Cycle:  3   Etot: -88.333549681980145   dEtot: +1.630e-04   |Residual|: 8.705e-03   |deigs|: 3.690e-03  t[s]:     29.18
SCF: Cycle:  4   Etot: -88.334479731158211   dEtot: -9.300e-04   |Residual|: 6.178e-03   |deigs|: 6.836e-03  t[s]:     30.57
SCF: Cycle:  5   Etot: -88.334786325146894   dEtot: -3.066e-04   |Residual|: 6.098e-03   |deigs|: 5.822e-03  t[s]:     31.99
SCF: Cycle:  6   Etot: -88.334949239260524   dEtot: -1.629e-04   |Residual|: 3.304e-03   |deigs|: 9.388e-03  t[s]:     33.37
SCF: Cycle:  7   Etot: -88.334983934987960   dEtot: -3.470e-05   |Residual|: 2.543e-03   |deigs|: 1.385e-02  t[s]:     34.74
SCF: Cycle:  8   Etot: -88.334979689020201   dEtot: +4.246e-06   |Residual|: 1.763e-03   |deigs|: 6.917e-03  t[s]:     36.07
SCF: Cycle:  9   Etot: -88.334994488827363   dEtot: -1.480e-05   |Residual|: 1.085e-03   |deigs|: 9.315e-03  t[s]:     37.46
SCF: Cycle: 10   Etot: -88.334999623306857   dEtot: -5.134e-06   |Residual|: 4.063e-04   |deigs|: 1.281e-03  t[s]:     38.82
SCF: Cycle: 11   Etot: -88.335000855864038   dEtot: -1.233e-06   |Residual|: 1.515e-04   |deigs|: 1.728e-03  t[s]:     39.91
SCF: Cycle: 12   Etot: -88.335000985534620   dEtot: -1.297e-07   |Residual|: 4.147e-05   |deigs|: 3.393e-04  t[s]:     41.01
SCF: Cycle: 13   Etot: -88.335000996799636   dEtot: -1.127e-08   |Residual|: 2.349e-05   |deigs|: 1.950e-04  t[s]:     42.35
SCF: Converged (|Delta E|<1.000000e-06 for 2 iters).

Setting wave functions to eigenvectors of Hamiltonian
Converging empty states (this may take a while): |deigs|: 2.090e-04

# Ionic positions in lattice coordinates:
ion W   0.000000000000000  -0.000000000000000   0.000000000000000 0
ion Se   0.666666666666667   0.333333333333333   0.121870594399722 1
ion Se   0.666666666666667   0.333333333333333  -0.121870594399722 1

# Forces in Lattice coordinates:
force W  -0.000000000000000   0.000000000000000   0.000000000000000 0
force Se  -0.000000000000000   0.000000000000000  -0.002546229143444 1
force Se  -0.000000000000000   0.000000000000000   0.002546229143331 1

# Energy components:
   Eewald =     -232.0651878912939310
       EH =     -163.3960449596260105
     Eloc =      279.1625478046489093
      Enl =       15.8813082662681246
      Exc =      -24.4538910794959676
 Exc_core =        9.7600623990407840
       KE =       26.7762044636584768
-------------------------------------
     Etot =      -88.3350009967996357

IonicMinimize: Iter:   0  Etot: -88.335000996799636  |grad|_K:  5.654e-05  t[s]:     51.05
IonicMinimize: Converged (|grad|_K<1.000000e-04).

#--- Lowdin population analysis ---
# oxidation-state W +0.361
# oxidation-state Se -0.074 -0.074


Dumping 'totalE.wfns' ... done
Dumping 'totalE.eigStats' ... 
	eMin: -2.901117 at state 0 ( [ +0.000000 +0.000000 +0.000000 ] spin 0 )
	HOMO: -0.177451 at state 18 ( [ +0.333333 +0.333333 +0.000000 ] spin 0 )
	mu  : -0.154509
	LUMO: -0.131140 at state 18 ( [ +0.333333 +0.333333 +0.000000 ] spin 0 )
	eMax: +0.246163 at state 3 ( [ +0.000000 +0.250000 +0.000000 ] spin 0 )
	HOMO-LUMO gap: +0.046311
	Optical gap  : +0.046311 at state 18 ( [ +0.333333 +0.333333 +0.000000 ] spin 0 )
End date and time: Sun Nov 24 20:58:59 2024  (Duration: 0-0:00:51.82)
Done!

PROFILER:              EdensityAndVscloc     0.175125 +/-     0.424909 s,   37 calls,      6.479620 s total
PROFILER:            ExCorrCommunication     0.038122 +/-     0.237498 s,  121 calls,      4.612739 s total
PROFILER:               ExCorrFunctional     0.002187 +/-     0.000441 s,   41 calls,      0.089670 s total
PROFILER:                    ExCorrTotal     0.122178 +/-     0.399346 s,   41 calls,      5.009295 s total
PROFILER:                    inv(matrix)     0.000029 +/-     0.000027 s,   13 calls,      0.000371 s total
PROFILER:                    matrix::set     0.000000 +/-     0.000000 s,  129 calls,      0.000040 s total
PROFILER:     RadialFunctionR::transform     0.009214 +/-     0.042359 s,   46 calls,      0.423827 s total
PROFILER:                    reduceKmesh     0.003015 +/-     0.000000 s,    1 calls,      0.003015 s total
PROFILER:               WavefunctionDrag     0.046493 +/-     0.000000 s,    1 calls,      0.046493 s total

MEMUSAGE:             complexScalarField     0.004272 GB
MEMUSAGE:        complexScalarFieldTilde     0.002136 GB
MEMUSAGE:                    IndexArrays     0.003254 GB
MEMUSAGE:                         matrix     0.000567 GB
MEMUSAGE:                           misc     0.010920 GB
MEMUSAGE:                     RealKernel     0.001625 GB
MEMUSAGE:                    ScalarField     0.033112 GB
MEMUSAGE:               ScalarFieldTilde     0.011917 GB
MEMUSAGE:                          Total     0.049596 GB
