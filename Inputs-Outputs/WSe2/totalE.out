
*************** jdftx 1.7  ***************

Start date and time: Sun Nov 24 20:59:00 2024
Executable /home/xujq/codes/jdftx/jdftx-202404/build/jdftx with command-line: -i totalE.in
Running on hosts (process indices):  node22 (0-13)  node23 (14-27)
Divided in process groups (process indices):  0 (0)  1 (1)  2 (2)  3 (3)  4 (4)  5 (5)  6 (6)  7 (7)  8 (8)  9 (9)  10 (10)  11 (11)  12 (12)  13 (13)  14 (14)  15 (15)  16 (16)  17 (17)  18 (18)  19 (19)  20 (20)  21 (21)  22 (22)  23 (23)  24 (24)  25 (25)  26 (26)  27 (27)
Resource initialization completed at t[s]:      0.01
Run totals: 28 processes, 112 threads, 0 GPUs


Input parsed successfully to the following command list (including defaults):

basis kpoint-dependent
converge-empty-states yes
coords-type Lattice
core-overlap-check vector
coulomb-interaction Slab 001
coulomb-truncation-embed 0 0 0
davidson-band-ratio 1.1
dump End State Vscloc BandEigs EigStats
dump Init Symmetries Kpoints Gvectors
dump-name totalE.$VAR
elec-cutoff 31
elec-eigen-algo Davidson
elec-ex-corr gga-PBE
elec-n-bands 50
electronic-minimize  \
	dirUpdateScheme      FletcherReeves \
	linminMethod         DirUpdateRecommended \
	nIterations          300 \
	history              15 \
	knormThreshold       0 \
	maxThreshold         no \
	energyDiffThreshold  1e-12 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
exchange-regularization WignerSeitzTruncated
fluid None
fluid-ex-corr (null) lda-PZ
fluid-gummel-loop 10 1.000000e-05
fluid-minimize  \
	dirUpdateScheme      PolakRibiere \
	linminMethod         DirUpdateRecommended \
	nIterations          100 \
	history              15 \
	knormThreshold       0 \
	maxThreshold         no \
	energyDiffThreshold  0 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
fluid-solvent H2O 55.338 ScalarEOS \
	epsBulk 78.4 \
	pMol 0.92466 \
	epsInf 1.77 \
	Pvap 1.06736e-10 \
	sigmaBulk 4.62e-05 \
	Rvdw 2.61727 \
	Res 1.42 \
	tauNuc 343133 \
	poleEl 15 7 1
forces-output-coords Positions
initial-state totalE.$VAR
ion W   0.000000000000000  -0.000000000000000   0.000000000000000 0
ion Se   0.666666666666667   0.333333333333333   0.121870594399722 1
ion Se   0.666666666666667   0.333333333333333  -0.121870594399722 1
ion-species /home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/W.upf
ion-species /home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/Se_fr_nv6.upf
ion-width 0
ionic-minimize  \
	dirUpdateScheme      L-BFGS \
	linminMethod         DirUpdateRecommended \
	nIterations          0 \
	history              15 \
	knormThreshold       0.0001 \
	maxThreshold         no \
	energyDiffThreshold  1e-06 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
kpoint   0.000000000000   0.000000000000   0.000000000000  1.00000000000000
kpoint-folding 12 12 1 
latt-move-scale 1 1 1
latt-scale 1 1 1 
lattice Hexagonal 6.27389 26
lattice-minimize  \
	dirUpdateScheme      L-BFGS \
	linminMethod         DirUpdateRecommended \
	nIterations          0 \
	history              15 \
	knormThreshold       0 \
	maxThreshold         no \
	energyDiffThreshold  1e-06 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
lcao-params -1 1e-06 0.001
pcm-variant GLSSA13
perturb-minimize  \
	nIterations            0 \
	algorithm              MINRES \
	residualTol            0.0001 \
	residualDiffThreshold  0.0001 \
	CGBypass               no \
	recomputeResidual      no
spintype spin-orbit
subspace-rotation-factor 1 yes
symmetries automatic
symmetry-threshold 0.0001



---------- Setting up symmetries ----------

Found 24 point-group symmetries of the bravais lattice
Found 12 space-group symmetries with basis
Applied RMS atom displacement 1.75008e-15 bohrs to make symmetries exact.

---------- Initializing the Grid ----------
R = 
[      6.27389     -3.13695            0  ]
[            0      5.43335            0  ]
[            0            0           26  ]
unit cell volume = 886.295
G =
[    1.00148   0.578205         -0  ]
[          0    1.15641          0  ]
[          0         -0   0.241661  ]
Minimum fftbox size, Smin = [  32  32  132  ]
Chosen fftbox size, S = [  32  32  140  ]

---------- Exchange Correlation functional ----------
Initalized PBE GGA exchange.
Initalized PBE GGA correlation.

---------- Setting up pseudopotentials ----------
Width of ionic core gaussian charges (only for fluid interactions / plotting) set to 0

Reading pseudopotential file '/home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/W.upf':
  'W' pseudopotential, 'PBE' functional
  Generated using ONCVPSP code by D. R. Hamann
  Author: anonymous  Date: 180416.
  14 valence electrons, 6 orbitals, 14 projectors, 1396 radial grid points, with lMax = 3
  Transforming local potential to a uniform radial grid of dG=0.02 with 1817 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 537 points.
    5S    l: 0   occupation:  2.0   eigenvalue: -2.899149
    5P    l: 1   occupation:  4.0   eigenvalue: -1.486754
    5P    l: 1   occupation:  2.0   eigenvalue: -1.847599
    5D    l: 2   occupation:  2.4   eigenvalue: -0.154393
    5D    l: 2   occupation:  1.6   eigenvalue: -0.181151
    6S    l: 0   occupation:  2.0   eigenvalue: -0.210123
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 537 points.
  Transforming core density to a uniform radial grid of dG=0.02 with 1817 points.
  Core radius for overlap checks: 2.00 bohrs.

Reading pseudopotential file '/home/xujq/pseudopotentials/oncv/dojo/nc-fr-04_pbe_standard/Se_fr_nv6.upf':
  'Se' pseudopotential, 'PBE' functional
  Generated using ONCVPSP code by D. R. Hamann
  Author: anonymous  Date: 190811.
  6 valence electrons, 3 orbitals, 8 projectors, 1214 radial grid points, with lMax = 2
  Transforming local potential to a uniform radial grid of dG=0.02 with 1817 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 537 points.
    4S    l: 0   occupation:  2.0   eigenvalue: -0.635120
    4P    l: 1   occupation:  2.7   eigenvalue: -0.234806
    4P    l: 1   occupation:  1.3   eigenvalue: -0.248593
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 537 points.
  Transforming core density to a uniform radial grid of dG=0.02 with 1817 points.
  Core radius for overlap checks: 1.88 bohrs.

Initialized 2 species with 3 total atoms.

Folded 1 k-points by 12x12x1 to 144 k-points.

---------- Setting up k-points, bands, fillings ----------
Adding inversion symmetry to k-mesh for non-inversion-symmetric unit cell.
Reduced to 19 k-points under symmetry. 
Computing the number of bands and number of electrons
Calculating initial fillings.
Turning on subspace rotations due to non-scalar fillings.
nElectrons:  26.000000   nBands: 50   nStates: 19

----- Setting up reduced wavefunction bases (one per k-point) -----
average nbasis = 7308.118 , ideal nbasis = 7306.590

---------- Setting up coulomb interaction ----------
Setting up double-sized grid for truncated Coulomb potentials:
R = 
[      6.27389     -3.13695            0  ]
[            0      5.43335            0  ]
[            0            0           52  ]
unit cell volume = 1772.59
G =
[    1.00148   0.578205         -0  ]
[          0    1.15641          0  ]
[          0         -0    0.12083  ]
Chosen fftbox size, S = [  32  32  280  ]
Integer grid location selected as the embedding center:
   Grid: [  0  0  0  ]
   Lattice: [  0  0  0  ]
   Cartesian: [  0  0  0  ]
Constructing Wigner-Seitz cell: 8 faces (6 quadrilaterals, 2 hexagons)
Range-separation parameter for embedded mesh potentials due to point charges: 0.558603 bohrs.
Initialized slab truncation along lattice direction 001

---------- Setting up 2D ewald sum ----------
Optimum gaussian width for ewald sums = 3.483012 bohr.
Real space sums over 289 unit cells with max indices [  8  8  0  ]
Reciprocal space sums over 81 terms with max indices [  4  4  0  ]

---------- Allocating electronic variables ----------
Initializing wave functions:  reading from 'totalE.wfns'


Dumping 'totalE.sym' ... done
Dumping 'totalE.kPts' ... done
Dumping 'totalE.kMap' ... done
Dumping 'totalE.Gvectors' ... done

---- Citations for features of the code used in this run ----

   Software package:
      R. Sundararaman, K. Letchworth-Weaver, K.A. Schwarz, D. Gunceler, Y. Ozhabes and T.A. Arias, 'JDFTx: software for joint density-functional theory', SoftwareX 6, 278 (2017)

   gga-PBE exchange-correlation functional:
      J.P. Perdew, K. Burke and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)

   Truncated Coulomb potentials:
      R. Sundararaman and T.A. Arias, Phys. Rev. B 87, 165122 (2013)

   Total energy minimization:
      T.A. Arias, M.C. Payne and J.D. Joannopoulos, Phys. Rev. Lett. 69, 1077 (1992)

This list may not be complete. Please suggest additional citations or
report any other bugs at https://github.com/shankar1729/jdftx/issues

Initialization completed successfully at t[s]:      2.58


-------- Electronic minimization -----------
ElecMinimize: Iter:   0  Etot: -88.335000974471015  |grad|_K:  3.287e-07  alpha:  1.000e+00
	SubspaceRotationAdjust: set factor to 0.598
ElecMinimize: Iter:   1  Etot: -88.335000999173445  |grad|_K:  4.750e-08  alpha:  4.981e-01  linmin: -7.954e-03  t[s]:      8.13
	SubspaceRotationAdjust: set factor to 0.362
ElecMinimize: Iter:   2  Etot: -88.335001000351141  |grad|_K:  1.997e-08  alpha:  2.714e-01  linmin: -2.269e-01  t[s]:      9.08
	SubspaceRotationAdjust: set factor to 0.215
ElecMinimize: Iter:   3  Etot: -88.335001000561022  |grad|_K:  1.461e-08  alpha:  1.588e-01  linmin: -2.865e-01  t[s]:     10.03
	SubspaceRotationAdjust: set factor to 0.127
	SubspaceRotationAdjust: resetting CG because factor has changed by 0.127095
ElecMinimize: 	State modified externally: resetting search direction.
ElecMinimize: Iter:   4  Etot: -88.335001000656192  |grad|_K:  9.097e-09  alpha:  9.348e-02
	SubspaceRotationAdjust: set factor to 0.0797
ElecMinimize: Iter:   5  Etot: -88.335001000682468  |grad|_K:  8.974e-09  alpha:  6.604e-02  linmin: -1.415e-01  t[s]:     12.38
	SubspaceRotationAdjust: set factor to 0.0522
ElecMinimize: Iter:   6  Etot: -88.335001000701752  |grad|_K:  7.342e-09  alpha:  4.328e-02  linmin: -1.522e-01  t[s]:     13.36
	SubspaceRotationAdjust: set factor to 0.0362
ElecMinimize: Iter:   7  Etot: -88.335001000720283  |grad|_K:  6.165e-09  alpha:  2.844e-02  linmin: -1.403e-01  t[s]:     14.27
	SubspaceRotationAdjust: set factor to 0.0268
ElecMinimize: Iter:   8  Etot: -88.335001000728482  |grad|_K:  5.341e-09  alpha:  1.806e-02  linmin: -1.228e-01  t[s]:     15.21
	SubspaceRotationAdjust: set factor to 0.0213
ElecMinimize: Iter:   9  Etot: -88.335001000733016  |grad|_K:  4.781e-09  alpha:  1.122e-02  linmin: -1.060e-01  t[s]:     16.13
	SubspaceRotationAdjust: set factor to 0.0179
ElecMinimize: Iter:  10  Etot: -88.335001000738345  |grad|_K:  4.401e-09  alpha:  8.216e-03  linmin: -9.226e-02  t[s]:     17.05
	SubspaceRotationAdjust: set factor to 0.0156
	SubspaceRotationAdjust: resetting CG because factor has changed by 0.12292
ElecMinimize: 	State modified externally: resetting search direction.
ElecMinimize: Iter:  11  Etot: -88.335001000742963  |grad|_K:  3.979e-09  alpha:  7.083e-03
	SubspaceRotationAdjust: set factor to 0.0145
ElecMinimize: Iter:  12  Etot: -88.335001000743787  |grad|_K:  3.975e-09  alpha:  2.380e-03  linmin: -3.901e-02  t[s]:     19.42
ElecMinimize: 	Step increased Etot by 9.521273e-13, reducing alpha to 5.675156e-05.
ElecMinimize: 	Step increased Etot by 1.321609e-12, reducing alpha to 5.675156e-06.
	SubspaceRotationAdjust: set factor to 0.0139
ElecMinimize: Iter:  13  Etot: -88.335001000744612  |grad|_K:  3.893e-09  alpha:  5.675e-06  linmin: -3.900e-02  t[s]:     21.54
ElecMinimize: Converged (|Delta Etot|<1.000000e-12 for 2 iters).
Setting wave functions to eigenvectors of Hamiltonian
Converging empty states (this may take a while): |deigs|: 5.246e-08

# Ionic positions in lattice coordinates:
ion W   0.000000000000000  -0.000000000000000   0.000000000000000 0
ion Se   0.666666666666667   0.333333333333333   0.121870594399722 1
ion Se   0.666666666666667   0.333333333333333  -0.121870594399722 1

# Forces in Lattice coordinates:
force W  -0.000000000000000   0.000000000000000   0.000000000000000 0
force Se  -0.000000000000000   0.000000000000000   0.000129540610104 1
force Se  -0.000000000000000  -0.000000000000000  -0.000129540609991 1

# Energy components:
   Eewald =     -232.0651878912939310
       EH =     -163.3974753280678556
     Eloc =      279.1640065854856516
      Enl =       15.8813044118549698
      Exc =      -24.4538689461638299
 Exc_core =        9.7600623990407840
       KE =       26.7761577683996137
-------------------------------------
     Etot =      -88.3350010007446116

IonicMinimize: Iter:   0  Etot: -88.335001000744612  |grad|_K:  2.877e-06  t[s]:     29.88
IonicMinimize: Converged (|grad|_K<1.000000e-04).

#--- Lowdin population analysis ---
# oxidation-state W +0.361
# oxidation-state Se -0.073 -0.073


Dumping 'totalE.wfns' ... done
Dumping 'totalE.Vscloc' ... done
Dumping 'totalE.eigenvals' ... done
Dumping 'totalE.eigStats' ... 
	eMin: -2.901183 at state 0 ( [ +0.000000 +0.000000 +0.000000 ] spin 0 )
	HOMO: -0.177512 at state 18 ( [ +0.333333 +0.333333 +0.000000 ] spin 0 )
	mu  : -0.154569
	LUMO: -0.131204 at state 18 ( [ +0.333333 +0.333333 +0.000000 ] spin 0 )
	eMax: +0.246126 at state 3 ( [ +0.000000 +0.250000 +0.000000 ] spin 0 )
	HOMO-LUMO gap: +0.046308
	Optical gap  : +0.046308 at state 18 ( [ +0.333333 +0.333333 +0.000000 ] spin 0 )
End date and time: Sun Nov 24 20:59:31 2024  (Duration: 0-0:00:30.80)
Done!

PROFILER:              EdensityAndVscloc     0.136301 +/-     0.186627 s,   31 calls,      4.225335 s total
PROFILER:            ExCorrCommunication     0.028322 +/-     0.101124 s,  103 calls,      2.917124 s total
PROFILER:               ExCorrFunctional     0.001888 +/-     0.000493 s,   35 calls,      0.066074 s total
PROFILER:                    ExCorrTotal     0.092959 +/-     0.172435 s,   35 calls,      3.253568 s total
PROFILER:                    matrix::set     0.000000 +/-     0.000000 s,  112 calls,      0.000027 s total
PROFILER:     RadialFunctionR::transform     0.001960 +/-     0.001904 s,   44 calls,      0.086220 s total
PROFILER:                    reduceKmesh     0.002699 +/-     0.000000 s,    1 calls,      0.002699 s total
PROFILER:               WavefunctionDrag     0.044700 +/-     0.000000 s,    1 calls,      0.044700 s total

MEMUSAGE:             complexScalarField     0.004272 GB
MEMUSAGE:                    IndexArrays     0.003254 GB
MEMUSAGE:                         matrix     0.000567 GB
MEMUSAGE:                           misc     0.010920 GB
MEMUSAGE:                     RealKernel     0.000542 GB
MEMUSAGE:                    ScalarField     0.011749 GB
MEMUSAGE:               ScalarFieldTilde     0.011917 GB
MEMUSAGE:                          Total     0.029281 GB
