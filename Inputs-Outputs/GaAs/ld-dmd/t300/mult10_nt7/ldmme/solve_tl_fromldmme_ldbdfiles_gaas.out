mu =  0.029399458006291925  ( 0.8  eV)
valley:
 [[ 0.33333  0.33333  0.     ]
 [-0.33333 -0.33333 -0.     ]]

##################################################
read ldbd files
##################################################
isMetal =  False
has_h =  False
nb =  2
nk_full =  13824000.0  nk =  1839
nkpair =  1667564
T =  0.000950043414701698
emin =  0.018480891  emax =  0.043612087
dim =  3
R = 
 [[0.      5.34145 5.34145]
 [5.34145 0.      5.34145]
 [5.34145 5.34145 0.     ]]
volume =  304.7947610901971
k:
 [[0.      0.      0.     ]
 [0.      0.      0.00417]
 [0.      0.      0.00833]
 [0.      0.      0.0125 ]
 [0.      0.      0.97083]
 [0.      0.      0.01667]
 [0.      0.      0.975  ]
 [0.      0.      0.02083]
 [0.      0.      0.97917]
 [0.      0.      0.025  ]]
k to valley:
 [[[-0.33333 -0.33333  0.     ]
  [ 0.33333  0.33333  0.     ]]

 [[-0.33333 -0.33333  0.00417]
  [ 0.33333  0.33333  0.00417]]

 [[-0.33333 -0.33333  0.00833]
  [ 0.33333  0.33333  0.00833]]

 [[-0.33333 -0.33333  0.0125 ]
  [ 0.33333  0.33333  0.0125 ]]

 [[-0.33333 -0.33333 -0.02917]
  [ 0.33333  0.33333 -0.02917]]

 [[-0.33333 -0.33333  0.01667]
  [ 0.33333  0.33333  0.01667]]

 [[-0.33333 -0.33333 -0.025  ]
  [ 0.33333  0.33333 -0.025  ]]

 [[-0.33333 -0.33333  0.02083]
  [ 0.33333  0.33333  0.02083]]

 [[-0.33333 -0.33333 -0.02083]
  [ 0.33333  0.33333 -0.02083]]

 [[-0.33333 -0.33333  0.025  ]
  [ 0.33333  0.33333  0.025  ]]]
valley of k:
 [0 0 0 0 1 0 1 0 1 0]
valley pol. of k:
 [-1 -1 -1 -1  1 -1  1 -1  1 -1]
Ek: [[0.03696 0.03696]
 [0.03713 0.03713]
 [0.03761 0.03761]
 [0.03839 0.03839]
 [0.04357 0.04357]
 [0.03941 0.03941]
 [0.04205 0.04205]
 [0.04065 0.04065]
 [0.04065 0.04065]
 [0.04205 0.04205]]
number of iterations:  49  , err =  0.9158118803089834
final mu =  7.946848e-01 eV
fk: [[2.84191e-04 2.84191e-04]
 [2.38941e-04 2.38940e-04]
 [1.43531e-04 1.43531e-04]
 [6.34360e-05 6.34357e-05]
 [2.70548e-07 2.70548e-07]
 [2.15073e-05 2.15072e-05]
 [1.34445e-06 1.34445e-06]
 [5.86151e-06 5.86148e-06]
 [5.86150e-06 5.86149e-06]
 [1.34445e-06 1.34445e-06]]

electron density =  1.000e+14 in cm^-d
hole density =  0.000e+00 in cm^-d
excess density =  1.000e+14 in cm^-d

sk:
 [[[[-0.44359+4.58661e-15j  0.12297-1.95203e-01j]
   [ 0.12297+1.95203e-01j  0.44359-4.57273e-15j]]

  [[ 0.19211-2.18575e-15j -0.03738-4.60106e-01j]
   [-0.03738+4.60106e-01j -0.19211+2.17187e-15j]]

  [[ 0.12775-1.38973e-15j  0.4832 +1.40862e-02j]
   [ 0.4832 -1.40862e-02j -0.12775+1.22233e-15j]]]


 [[[-0.12713+1.73472e-15j  0.16884+4.53077e-01j]
   [ 0.16884-4.53077e-01j  0.12713-1.72432e-15j]]

  [[-0.27339+3.39832e-15j  0.36129-2.11375e-01j]
   [ 0.36129+2.11375e-01j  0.27339-3.42608e-15j]]

  [[ 0.39878-5.05027e-15j  0.30154-4.45495e-04j]
   [ 0.30154+4.45495e-04j -0.39878+4.88544e-15j]]]


 [[[-0.14871+2.51188e-15j  0.19815+4.34083e-01j]
   [ 0.19815-4.34083e-01j  0.14871-2.48759e-15j]]

  [[-0.25942+3.57527e-15j  0.34798-2.47833e-01j]
   [ 0.34798+2.47833e-01j  0.25942-3.57873e-15j]]

  [[ 0.4004 -5.69330e-15j  0.29915+7.26719e-04j]
   [ 0.29915-7.26719e-04j -0.4004 +5.52361e-15j]]]


 [[[-0.18157+3.17454e-15j  0.24567+3.95333e-01j]
   [ 0.24567-3.95333e-01j  0.18157-3.15720e-15j]]

  [[-0.23141+3.34802e-15j  0.32039-3.05628e-01j]
   [ 0.32039+3.05628e-01j  0.23141-3.40353e-15j]]

  [[ 0.40365-6.09192e-15j  0.2944 +2.67681e-03j]
   [ 0.2944 -2.67681e-03j -0.40365+5.93557e-15j]]]


 [[[ 0.06704+3.74700e-16j  0.01409+4.94141e-01j]
   [ 0.01409-4.94141e-01j -0.06704-3.33067e-16j]]

  [[-0.49254-2.47111e-15j -0.04156+6.74398e-02j]
   [-0.04156-6.74398e-02j  0.49254+2.40866e-15j]]

  [[-0.04355-1.90386e-16j  0.4969 -7.69234e-03j]
   [ 0.4969 +7.69234e-03j  0.04355+3.14527e-16j]]]


 [[[-0.22633+3.57006e-15j  0.30573+3.23564e-01j]
   [ 0.30573-3.23564e-01j  0.22633-3.54231e-15j]]

  [[-0.18658+2.55004e-15j  0.26412-3.80548e-01j]
   [ 0.26412+3.80548e-01j  0.18658-2.56739e-15j]]

  [[ 0.40385-6.10227e-15j  0.29371+5.44596e-03j]
   [ 0.29371-5.44596e-03j -0.40385+6.01786e-15j]]]


 [[[ 0.1254 +2.70617e-16j  0.08491+4.75470e-01j]
   [ 0.08491-4.75470e-01j -0.1254 -2.22045e-16j]]

  [[-0.41175-1.56472e-15j -0.23828+1.50630e-01j]
   [-0.23828-1.50630e-01j  0.41175+1.49186e-15j]]

  [[-0.25296-9.62446e-16j  0.43003-9.55749e-03j]
   [ 0.43003+9.55749e-03j  0.25296+1.07293e-15j]]]


 [[[-0.28045+4.19109e-15j  0.3551 +2.10807e-01j]
   [ 0.3551 -2.10807e-01j  0.28045-4.21191e-15j]]

  [[-0.12277+1.68268e-15j  0.17114-4.52573e-01j]
   [ 0.17114+4.52573e-01j  0.12277-1.73819e-15j]]

  [[ 0.39389-5.63243e-15j  0.30653+8.61958e-03j]
   [ 0.30653-8.61958e-03j -0.39389+5.60012e-15j]]]


 [[[ 0.15929+3.76435e-16j -0.33167-3.37346e-01j]
   [-0.33167+3.37346e-01j -0.15929-3.90313e-16j]]

  [[-0.16302-3.66027e-16j  0.29601-3.67407e-01j]
   [ 0.29601+3.67407e-01j  0.16302+3.15720e-16j]]

  [[-0.44416-9.62880e-16j -0.22744+1.32816e-02j]
   [-0.22744-1.32816e-02j  0.44416+1.00451e-15j]]]


 [[[-0.33577+4.46431e-15j  0.36131+7.56472e-02j]
   [ 0.36131-7.56472e-02j  0.33577-4.44523e-15j]]

  [[-0.0425 +3.81639e-16j  0.06308-4.93176e-01j]
   [ 0.06308+4.93176e-01j  0.0425 -4.16334e-16j]]

  [[ 0.36627-4.68354e-15j  0.33871+1.12603e-02j]
   [ 0.33871-1.12603e-02j -0.36627+4.68224e-15j]]]]

number of states within [emin,emax]:  3678
number of elements of rho left:  7356
mask_Ek and mask_rho are right

--------------------------------------------------
carrier transport from conventional method
--------------------------------------------------
carrier lifetime (rate average) in ps:  0.23023797497955198
carrier lifetime (time average) in ps:  0.25087988323557003
momentum lifetime (rate average) in ps:  0.4306699800413134
momentum lifetime (time average) in ps:  0.4405561419077368
momentum lifetime (type 2, rate average) in ps:  0.18373849291843644
momentum lifetime (type 2, time average) in ps:  0.494598600557164
average of v^2 =  [0.0139 0.0139 0.0139]
Fermi velocity in m/s =  [257927.25106 257927.17571 257927.20326]
conductivity using tau in S/m =  [8.53088 8.543   8.53341]
conductivity using taum in S/m =  [16.75723 16.84115 16.77478]
conductivity using taum2 in S/m =  [16.95133 17.02971 16.96761]
mobility using tau in cm^2/V/s =  [5324.55885 5332.12066 5326.13811]
mobility using taum in cm^2/V/s =  [10459.0406  10511.41606 10469.99412]
mobility using taum2 in cm^2/V/s =  [10580.18543 10629.10872 10590.34938]
time for compute_carrier_transport_conventional:  0.3042590911500156
carrier lifetime (rate average) in ps:  0.23023797497955184
effetive lifetime (single element of rho, rate average) in ps:  0.23023746437134648

time for set up and some simple analysis:  12.067646777722985

##################################################
solving spin lifetimes
##################################################

--------------------------------------------------
solve L:
--------------------------------------------------
rates:
 [6.82662e-21-2.87649e-21j 6.73968e-07-3.89950e-21j
 6.74829e-07-2.10507e-21j 6.75506e-07+6.82910e-22j
 5.12875e-05-1.86116e-21j 5.36876e-05+4.26944e-21j
 5.38959e-05-1.29580e-21j 5.38991e-05-1.45712e-21j
 5.40521e-05+1.82979e-21j 5.40529e-05-1.02807e-21j]
spin lifetimes in ps:
 [3.54331e+15 3.58902e+01 3.58444e+01 3.58085e+01 4.71632e-01 4.50548e-01
 4.48807e-01 4.48780e-01 4.47510e-01 4.47503e-01]
precession freq. in au:
 [-2.87649e-21 -3.89950e-21 -2.10507e-21  6.82910e-22 -1.86116e-21
  4.26944e-21 -1.29580e-21 -1.45712e-21  1.82979e-21 -1.02807e-21]
short lifetimes in ps:
 [0.13654 0.13626 0.13623 0.13621 0.13611 0.13609 0.13598 0.13589 0.1357
 0.13336]
normR = 
 [1.54113 1.516   1.51715 1.51476 2.53547 1.32827 1.32039 1.30523 1.32929
 1.3158 ]
normL = 
 [1.54113 1.516   1.51715 1.51476 2.53547 1.32827 1.32039 1.30523 1.32929
 1.3158 ]
7356  (of  7356 ) modes are considered
7356  (of  7356 ) modes are considered
7356  (of  7356 ) modes are considered
3  (of  7356 ) modes are considered
7356  (of  7356 ) modes are considered
7356  (of  7356 ) modes are considered

Analyse decay mode:

The 4 observables and perturbations are:
n, sx, sy, sz
ob. proj. to VR = 
 [[ 0.64887-7.26497e-15j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j -0.21826-1.98739e-01j  0.01771+1.61233e-02j
   0.07878+7.17315e-02j]
 [ 0.     +0.00000e+00j -0.07396+1.42649e-02j  0.23623-4.55615e-02j
  -0.18541+3.57613e-02j]
 [ 0.     +0.00000e+00j -0.08667+2.22226e-02j -0.20958+5.37397e-02j
  -0.20336+5.21437e-02j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]]
rhopert. proj. to VL = 
 [[-0.64887-7.26497e-15j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.46001-4.18861e-01j -0.00545+4.95885e-03j
  -0.19043+1.73399e-01j]
 [ 0.     +0.00000e+00j  0.12052+2.32446e-02j -0.4781 -9.22123e-02j
   0.44137+8.51281e-02j]
 [ 0.     +0.00000e+00j  0.1989 +5.10007e-02j  0.42061+1.07849e-01j
   0.45654+1.17061e-01j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]]
ob. of pert:
 [[-0.42104  0.       0.       0.     ]
 [ 0.      -0.21029  0.       0.     ]
 [ 0.       0.      -0.21029  0.     ]
 [ 0.       0.       0.      -0.21029]]

mode  0  with rate  1.464853124671963e+20
pert. and ob.:
 [[-0.42104  0.       0.       0.     ]
 [ 0.       0.       0.       0.     ]
 [ 0.       0.       0.       0.     ]
 [ 0.       0.       0.       0.     ]]

mode  1  with rate  1483750.8125173093
pert. and ob.:
 [[ 0.00000e+00  0.00000e+00  0.00000e+00  0.00000e+00]
 [ 0.00000e+00 -1.83647e-01  1.48989e-02  6.62842e-02]
 [ 0.00000e+00  2.17417e-03 -1.76386e-04 -7.84731e-04]
 [ 0.00000e+00  7.60256e-02 -6.16780e-03 -2.74402e-02]]

mode  2  with rate  1481857.9333260676
pert. and ob.:
 [[ 0.       0.       0.       0.     ]
 [ 0.      -0.00925  0.02953 -0.02318]
 [ 0.       0.03668 -0.11714  0.09194]
 [ 0.      -0.03386  0.10814 -0.08488]]

mode  3  with rate  1480370.7520804547
pert. and ob.:
 [[ 0.       0.       0.       0.     ]
 [ 0.      -0.01837 -0.04443 -0.04311]
 [ 0.      -0.03885 -0.09395 -0.09116]
 [ 0.      -0.04217 -0.10197 -0.09895]]

mode  4  with rate  19497.91489271238
pert. and ob.:
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]

mode  5  with rate  18626.28324776482
pert. and ob.:
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]

mode  6  with rate  18554.297099563144
pert. and ob.:
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]

mode  7  with rate  18553.168889333952
pert. and ob.:
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]

mode  8  with rate  18500.676660641668
pert. and ob.:
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]

mode  9  with rate  18500.406434252043
pert. and ob.:
 [[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]
<s|UR>:
 [[-0.43727-0.39815j -0.14817+0.02858j -0.17363+0.04452j]
 [ 0.03547+0.0323j   0.47325-0.09128j -0.41988+0.10766j]
 [ 0.15782+0.14371j -0.37146+0.07164j -0.40741+0.10446j]]
normR_rotate =  [1.51357 1.51352 1.51353]
normL_rotate =  [1.51357 1.51352 1.51353]
<s|UR>:
 [[ 6.29533e-01+4.53602e-16j  6.49546e-16+1.06149e-16j
  -1.38778e-17-2.39002e-16j]
 [-5.07949e-16-1.72897e-16j  6.29504e-01+1.17974e-16j
  -1.13267e-15-8.11322e-16j]
 [ 2.07787e-16+5.20929e-16j  1.34007e-16+3.11213e-16j
   6.29509e-01+2.85437e-16j]]
oUs_rotate:
 [[ 1.00000e+00-1.81842e-15j  1.82341e-15+1.20220e-16j
   1.04083e-15+1.17541e-15j]
 [ 1.51983e-15+4.55108e-16j  1.00000e+00+8.91588e-16j
  -4.23706e-16+4.42261e-16j]
 [ 1.35612e-15+1.13874e-15j -2.21828e-16+5.05157e-16j
   1.00000e+00+5.54978e-16j]]
UL^H -L UR:
 [[ 6.73968e-07+4.17881e-22j -3.83843e-21-3.48233e-21j
   2.16072e-20-1.06442e-20j]
 [-1.82013e-20-1.80764e-20j  6.74829e-07+4.11180e-22j
  -4.92593e-20+1.49458e-20j]
 [ 1.22549e-20+1.73842e-20j -4.42807e-20+8.25242e-22j
   6.75506e-07+4.04199e-22j]]
UL^H -L UR (rotated):
 [[6.74139e-07+3.25722e-22j 1.33520e-10+1.62218e-22j
  4.45105e-10+5.26048e-21j]
 [2.03287e-10+7.55888e-22j 6.75129e-07+1.43160e-21j
  3.02092e-10+1.42249e-21j]
 [4.08456e-10+1.98959e-21j 2.89320e-10+8.96018e-22j
  6.75034e-07+4.94383e-22j]]

time for spin lifetime:  431.41135776787996

##################################################
solving lifetimes approximately
##################################################

--------------------------------------------------
Rayleigh-Ritz method (material dependent):
--------------------------------------------------
Rayleigh-Ritz ( 3  vec.,  s, without coherent ) lifetime in ps:
 [1037.01318 1035.54082 1035.54082]

Rayleigh-Ritz ( 3  vec.,  s ) lifetime in ps:
 [1037.00932 1035.54274 1035.54274]

Rayleigh-Ritz ( 3  vec.,  s, with Left ) lifetime in ps:
 [1576.64336 1557.91941 1532.35961]

Rayleigh-Ritz ( 6  vec.,   ) lifetime in ps:
 [177.23115 177.23115 177.21877   0.23981   0.23964   0.23957]

Rayleigh-Ritz ( 6  vec.,  with Left ) lifetime in ps:
 [33.63809 33.59601 33.55571  0.20274  0.20253  0.20237]

Rayleigh-Ritz ( 7  vec.,   ) lifetime in ps:
 [5.11008e+12 1.77231e+02 1.77231e+02 1.77219e+02 2.39808e-01 2.39637e-01
 2.39565e-01]

Rayleigh-Ritz ( 7  vec.,  with Left ) lifetime in ps:
 [2.09706e+15 3.36381e+01 3.35960e+01 3.35557e+01 2.02737e-01 2.02535e-01
 2.02366e-01]

Rayleigh-Ritz ( 30  vec.,   ) lifetime in ps:
 [35.88361 35.8379  35.80203  0.44109  0.44101  0.44089  0.30852  0.30846
  0.30837  0.23767  0.23762  0.2375   0.18536  0.18536  0.18526  0.18526
  0.18523  0.18523  0.17088  0.17088  0.17067  0.17067  0.17059  0.17059
  0.14698  0.14698  0.14685  0.14685  0.14678  0.14678]

Rayleigh-Ritz ( 30  vec.,  with Left ) lifetime in ps:
 [35.89021 35.84442 35.80845 -0.54095 -0.47231 -0.44153  0.43274  0.43267
  0.43258  0.22257  0.22198  0.2216   0.18065  0.18065  0.18051  0.18051
  0.1803   0.1803   0.16778  0.16778  0.16772  0.16772  0.16763  0.16763
  0.1451   0.1451   0.14509  0.14509  0.14494  0.14494]


time for Rayleigh-Ritz lifetime:  20.876068667974323

--------------------------------------------------
iterative method
--------------------------------------------------

--------------------------------------------------
Approximate formula based on Rayleigh-Ritz method with minimum Krylov subspace:
--------------------------------------------------
EY spin lifetime (along z) in ps:
 1036.8374172656504
norm of rhosz =  (0.9999999999999984+0j)
LEsz =  (-3.0377402516380416e-25+1.1586990924277958e-23j)
LE2sz =  (-1.1994087221016992e-11+9.167296744954746e-31j)
LE3sz =  (2.51736247898775e-35-9.780112999289848e-34j)
taup from LELscLEsz / LE2sz in ps =  -0.23939346299402461
-LKdir = 
 [[ 2.33294e-08-4.05434e-20j -1.14219e-11-2.17433e-24j]
 [ 1.19950e-11-1.72897e-27j  1.21195e-15+7.74821e-31j]]
IKdir =
 [[1.00000e+00+5.48678e-21j 2.33294e-08-4.04517e-20j]
 [2.33294e-08+4.04566e-20j 1.19950e-11+1.53962e-31j]]
-LK11 =  (2.332944670307893e-08-4.0667807337069064e-20j)
-LK12 =  (-1.199356373703956e-11-6.366391837312681e-28j)
-LK21 =  (1.1994631484100463e-11-9.167296744964168e-31j)
-LK22 =  (1.2119090270942541e-15-1.8478734202858153e-31j)
IK^(-1) =
 [[ 1.00005e+00+4.03458e-21j -1.94502e+03+3.37254e-09j]
 [-1.94502e+03-3.37295e-09j  8.33720e+10-2.76328e-10j]]
IK^(-1)_11 =  (1.0000453776159404+3.4682928616351404e-24j)
IK^(-1)_12 =  (-1945.0789604230345+3.390654478708151e-09j)
IK^(-1)_21 =  (-1945.0789604230345-3.390654776039923e-09j)
IK^(-1)_22 =  (83374414540.50131+6.372456569192962e-09j)
IK^(-1) LK = 
 [[ 1.10723e-21-8.83945e-23j -1.37797e-11+1.91142e-24j]
 [ 1.00000e+00-1.43982e-16j  1.01065e-04+1.07353e-19j]]
T =  (0.0001010655340388174+2.526845886172669e-20j)
D =  (1.4351366726916362e-11-4.108887528360606e-24j)
Em =  (1.4220068094686258e-07-4.080605775289997e-20j)  Ep =  (0.00010092333335787053+6.607451661462665e-20j)
lifetimes in ps =  170.10356845545533   0.2396754294676755

--------------------------------------------------
generalized EY+DP formula with L^C = its diagonal:
--------------------------------------------------
taup from LELscLEsz / LE2sz in ps =  0.19094734810252295
lifetimes in ps =  204.81761144171963   0.1910903059475279

time for approximate lifetime:  22.45382086932659

##################################################
solving spin diffusion length
##################################################
effective lifetime in ps:  0.47215240478553755

--------------------------------------------------
carrier transport from linearized DMME
--------------------------------------------------
conductivity in S/m =  16.484110446971176
mobility in cm^2/V/s =  10288.572493907212

--------------------------------------------------
solving -L^(-1) Lv x = x lambda^(-1)
--------------------------------------------------
spin diffusion length using pinv of L in micro-meter:
 [-0.95454 -0.95454  0.95453  0.95453 -0.95379  0.95378  0.16664 -0.16664
 -0.14205  0.14205  0.14198 -0.14198  0.13493 -0.13493  0.13482 -0.13482
  0.13454  0.13454 -0.13454 -0.13454]
precession freq. in au:
 [ 2.29198e-08 -2.29198e-08  2.65026e-08 -2.65026e-08  8.89905e-18
  9.14703e-18  4.84704e-18  2.94898e-18  2.98251e-18  6.31543e-18
  1.82206e-17 -8.57323e-18  4.37540e-18  3.00536e-18  4.86514e-18
  2.60216e-18  9.81065e-05 -9.81065e-05  9.81029e-05 -9.81029e-05]
short diffusion length using pinv of L in micro-meter:
 [-2.67758e-08 -2.53749e-08 -2.53710e-08  2.32008e-08  2.32008e-08
 -2.27411e-08 -2.27404e-08 -1.72223e-08 -1.72223e-08  1.47989e-08
 -1.38145e-08 -1.38145e-08 -1.27635e-08 -1.05110e-08 -9.40629e-09
 -9.40629e-09  3.78726e-09 -1.93032e-09 -1.93031e-09 -1.91966e-09]
normR = 
 [4.72058 4.72058 4.56659 4.56659 4.36971 4.28899 2.14696 2.14696 2.99622
 2.97423]
normL = 
 [4.72058 4.72058 4.56659 4.56659 4.36971 4.28899 2.14696 2.14696 2.99622
 2.97423]
3676  (of  7356 ) modes are considered
3676  (of  7356 ) modes are considered
3676  (of  7356 ) modes are considered
3676  (of  7356 ) modes are considered
68  (of  7356 ) modes are considered
3676  (of  7356 ) modes are considered
3676  (of  7356 ) modes are considered

Analyse decay mode:

The 4 observables and perturbations are:
n, sx, sy, sz
ob. proj. to VR = 
 [[ 0.00000e+00+0.00000e+00j -3.65352e-01-4.82633e-01j
  -6.28627e-01+6.64759e-02j  3.96802e-01+1.91411e-01j]
 [ 0.00000e+00+0.00000e+00j -3.65352e-01+4.82633e-01j
  -6.28627e-01-6.64759e-02j  3.96802e-01-1.91411e-01j]
 [ 0.00000e+00+0.00000e+00j -1.04143e-01+6.13012e-01j
   4.58488e-01-4.00508e-01j -3.24872e-01-1.88926e-01j]
 [ 0.00000e+00+0.00000e+00j -1.04143e-01-6.13012e-01j
   4.58488e-01+4.00508e-01j -3.24872e-01+1.88926e-01j]
 [ 0.00000e+00+0.00000e+00j -5.04935e-01+1.59437e-12j
  -5.52852e-01-1.14113e-11j -5.11899e-01+4.84772e-12j]
 [ 0.00000e+00+0.00000e+00j -2.50176e-01+2.16646e-01j
  -2.40941e-01+2.08648e-01j -5.76411e-01+4.99156e-01j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j
   0.00000e+00+0.00000e+00j -1.41682e-04+2.21751e-13j]
 [ 0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j
   0.00000e+00+0.00000e+00j  0.00000e+00+0.00000e+00j]
 [ 0.00000e+00+0.00000e+00j -1.68964e-03-1.67720e-13j
   2.40787e-01-1.19429e-12j -1.03198e-01+5.80514e-12j]
 [ 0.00000e+00+0.00000e+00j -8.97930e-04+2.01635e-13j
  -2.56224e-01+3.49880e-12j  1.01984e-02-2.34682e-12j]]
rhopert. proj. to VL = 
 [[ 0.     +0.00000e+00j -0.01239-9.33256e-02j  0.05924+6.68021e-02j
  -0.05177+1.99355e-02j]
 [ 0.     +0.00000e+00j -0.01239+9.33256e-02j  0.05924-6.68021e-02j
  -0.05177-1.99355e-02j]
 [ 0.     +0.00000e+00j -0.04035+7.45498e-02j -0.08718-4.61790e-03j
   0.05397-3.04186e-02j]
 [ 0.     +0.00000e+00j -0.04035-7.45498e-02j -0.08718+4.61790e-03j
   0.05397+3.04186e-02j]
 [ 0.     +0.00000e+00j  0.05063-8.88438e-14j  0.04197+4.83820e-13j
   0.113  -9.36836e-14j]
 [ 0.     +0.00000e+00j  0.05394+4.67063e-02j  0.05438+4.70920e-02j
   0.0595 +5.15228e-02j]
 [-0.02427-2.39537e-16j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [-0.02427+3.06766e-16j  0.     +0.00000e+00j  0.     +0.00000e+00j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j  0.00188+1.79991e-14j
   0.     +0.00000e+00j]
 [ 0.     +0.00000e+00j  0.     +0.00000e+00j -0.00181-2.80564e-14j
   0.00077-2.81957e-14j]]
ob. of pert:
 [[-0.42104  0.       0.       0.     ]
 [ 0.      -0.21029  0.       0.     ]
 [ 0.       0.      -0.21029  0.     ]
 [ 0.       0.       0.      -0.21029]]

mode  0  with rate  -18038.15495042698
pert. and ob.:
 [[ 0.00000e+00  0.00000e+00  1.41937e-08  0.00000e+00]
 [ 0.00000e+00 -4.05159e-02  1.39915e-02  1.29478e-02]
 [ 0.00000e+00  1.05992e-02 -4.16775e-02  1.07180e-02]
 [ 0.00000e+00  2.85351e-02  3.12175e-02 -2.43575e-02]]

mode  1  with rate  -18038.15495042676
pert. and ob.:
 [[ 0.00000e+00  0.00000e+00  1.41937e-08  0.00000e+00]
 [ 0.00000e+00 -4.05159e-02  1.39915e-02  1.29478e-02]
 [ 0.00000e+00  1.05992e-02 -4.16775e-02  1.07180e-02]
 [ 0.00000e+00  2.85351e-02  3.12175e-02 -2.43575e-02]]

mode  2  with rate  18038.01892909565
pert. and ob.:
 [[ 0.00000e+00  2.05117e-07  2.08487e-07 -3.76347e-07]
 [ 0.00000e+00 -4.14979e-02  1.13583e-02  2.71926e-02]
 [ 0.00000e+00  1.19099e-02 -4.18198e-02  2.74494e-02]
 [ 0.00000e+00  1.30264e-02  1.25613e-02 -2.32799e-02]]

mode  3  with rate  18038.018929095528
pert. and ob.:
 [[ 0.00000e+00  2.05117e-07  2.08487e-07 -3.76347e-07]
 [ 0.00000e+00 -4.14979e-02  1.13583e-02  2.71926e-02]
 [ 0.00000e+00  1.19099e-02 -4.18198e-02  2.74494e-02]
 [ 0.00000e+00  1.30264e-02  1.25613e-02 -2.32799e-02]]

mode  4  with rate  -18023.9590686425
pert. and ob.:
 [[ 0.00000e+00  2.06471e-07  2.26064e-07  2.09318e-07]
 [ 0.00000e+00 -2.55660e-02 -2.79922e-02 -2.59186e-02]
 [ 0.00000e+00 -2.11907e-02 -2.32017e-02 -2.14830e-02]
 [ 0.00000e+00 -5.70575e-02 -6.24722e-02 -5.78444e-02]]

mode  5  with rate  18023.762650683115
pert. and ob.:
 [[ 0.00000e+00 -4.82072e-07 -4.64277e-07 -1.11070e-06]
 [ 0.00000e+00 -2.36120e-02 -2.27403e-02 -5.44024e-02]
 [ 0.00000e+00 -2.38070e-02 -2.29282e-02 -5.48518e-02]
 [ 0.00000e+00 -2.60469e-02 -2.50854e-02 -6.00126e-02]]

mode  6  with rate  3149.0671634403298
pert. and ob.:
 [[ 0.00000e+00  5.38310e-07 -1.91509e-06  3.43909e-06]
 [ 0.00000e+00  0.00000e+00  0.00000e+00  0.00000e+00]
 [ 0.00000e+00  0.00000e+00  0.00000e+00  0.00000e+00]
 [ 0.00000e+00  0.00000e+00  0.00000e+00  0.00000e+00]]

mode  7  with rate  -3149.0622894795447
pert. and ob.:
 [[ 0.00000e+00 -2.99507e-07  2.16605e-06 -8.22863e-07]
 [ 0.00000e+00  0.00000e+00  0.00000e+00  0.00000e+00]
 [ 0.00000e+00  0.00000e+00  0.00000e+00  0.00000e+00]
 [ 0.00000e+00  0.00000e+00  0.00000e+00  0.00000e+00]]

mode  8  with rate  -2684.3236907606693
pert. and ob.:
 [[ 0.00000e+00  0.00000e+00  4.16886e-07 -1.78672e-07]
 [ 0.00000e+00 -2.96666e-08  4.22770e-06 -1.81194e-06]
 [ 0.00000e+00 -3.18019e-06  4.53201e-04 -1.94236e-04]
 [ 0.00000e+00  1.24905e-07 -1.77999e-05  7.62879e-06]]

mode  9  with rate  2684.313766171064
pert. and ob.:
 [[ 0.00000e+00  0.00000e+00 -1.51944e-06  6.04782e-08]
 [ 0.00000e+00  0.00000e+00 -2.07080e-06  8.24239e-08]
 [ 0.00000e+00  1.62160e-06  4.62724e-04 -1.84177e-05]
 [ 0.00000e+00 -6.94774e-07 -1.98254e-04  7.89106e-06]]

time for diffusion length:  422.30275698006153

##################################################
solving approximate diffusion lengths
##################################################

--------------------------------------------------
Rayleigh-Ritz method:
--------------------------------------------------
Rayleigh-Ritz ( 2  vec.,  sz vsz ) diffusion length in micro-meter:
 [ 0.79111 -0.79081]
precession frequency: [1.39408e-17 1.26793e-17]

Rayleigh-Ritz ( 2  vec.,  sz vsz, with Left ) diffusion length in micro-meter:
 [ 0.92723 -0.92721]
precession frequency: [9.93741e-18 9.29746e-18]

Rayleigh-Ritz ( 2  vec.,  sx vsx ) diffusion length in micro-meter:
 [ 0.79193 -0.79193]
precession frequency: [1.36313e-17 1.28856e-17]

AK = 
 [[6.73968e-07+1.13085e-21j 6.79796e-11+2.13533e-19j]
 [1.00168e-19-5.13745e-21j 4.93773e-05-1.46328e-20j]]
BK = 
 [[-5.19976e-08-4.30808e-15j -8.63312e-02+8.44985e-16j]
 [-8.63312e-02-5.78777e-19j  6.38005e-07-4.30628e-15j]]
Rayleigh-Ritz ( 2  vec.,  sx vsx, with Left ) diffusion length in micro-meter:
 [-0.92828  0.92819]
precession frequency: [9.75846e-18 1.03653e-17]

Rayleigh-Ritz ( 4  vec.,  sxy vsxy ) diffusion length in micro-meter:
 [ 0.79189 -0.79189 -0.79155  0.79125]
precession frequency: [1.37463e-17 1.30237e-17 1.24593e-17 1.34339e-17]

Rayleigh-Ritz ( 4  vec.,  sxz vsxz ) diffusion length in micro-meter:
 [ 0.79192 -0.79192  0.79113 -0.79082]
precession frequency: [1.35321e-17 1.28750e-17 1.40318e-17 1.26691e-17]

AK = 
 [[ 6.73968e-07+1.13093e-21j  7.59436e-12-1.15617e-11j
   6.79796e-11+2.13532e-19j -1.04755e-09+1.59480e-09j]
 [-8.08491e-21-1.54082e-20j  6.75506e-07+6.27206e-21j
  -4.95984e-10-7.55089e-10j -1.80162e-09-1.98686e-19j]
 [ 1.00168e-19-5.13728e-21j  3.08421e-20-3.98395e-20j
   4.93773e-05-1.46318e-20j -5.97407e-10+9.09495e-10j]
 [-8.90529e-20-1.33612e-19j -7.99652e-20-1.13219e-21j
  -1.21325e-09-1.84705e-09j  4.93842e-05-6.89144e-21j]]
BK = 
 [[-5.19976e-08-4.30807e-15j  4.95473e-08-7.54310e-08j
  -8.63312e-02+8.45016e-16j -1.10217e-13+1.67804e-13j]
 [ 4.95473e-08+7.54310e-08j  5.94773e-07-4.30788e-15j
  -2.63884e-07-4.01738e-07j  8.63304e-02-8.45278e-16j]
 [-8.63312e-02-5.75492e-19j -2.63884e-07+4.01738e-07j
   6.38005e-07-4.30626e-15j -1.48637e-06+2.26285e-06j]
 [-1.10216e-13-1.67804e-13j  8.63304e-02-1.51680e-19j
  -1.48637e-06-2.26285e-06j  9.11539e-06-4.30606e-15j]]
Rayleigh-Ritz ( 6  vec.,  s vs ) diffusion length in micro-meter:
 [ 0.79189 -0.79188 -0.79155  0.79119  0.79119 -0.79082]
precession frequency: [ 1.36568e-17  1.29776e-17  1.26538e-17  9.67792e-09 -9.67792e-09
  1.25174e-17]

Rayleigh-Ritz ( 6  vec.,  s vs, with Left ) diffusion length in micro-meter:
 [-0.92796 -0.92796  0.92795  0.92795 -0.92726  0.92725]
precession frequency: [ 2.29999e-08 -2.29999e-08  2.67275e-08 -2.67275e-08  9.34204e-18
  9.88320e-18]


time for Rayleigh-Ritz diffusion length:  11.127698021009564

--------------------------------------------------
iterative method:
--------------------------------------------------

time for approximate diffusion length:  11.127742471639067
total time:  899.3633248666301
